<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>stream_socket_client</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK
REL="HOME"
TITLE="Manuale PHP"
HREF="index.html"><LINK
REL="UP"
TITLE="Stream Functions"
HREF="ref.stream.html"><LINK
REL="PREVIOUS"
TITLE="stream_socket_accept"
HREF="function.stream-socket-accept.html"><LINK
REL="NEXT"
TITLE="stream_socket_enable_crypto"
HREF="function.stream-socket-enable-crypto.html"><META
HTTP-EQUIV="Content-type"
CONTENT="text/html; charset=UTF-8"></HEAD
><BODY
CLASS="refentry"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Manuale PHP</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="function.stream-socket-accept.html"
ACCESSKEY="P"
>Indietro</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="function.stream-socket-enable-crypto.html"
ACCESSKEY="N"
>Avanti</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><H1
><A
NAME="function.stream-socket-client"
></A
>stream_socket_client</H1
><DIV
CLASS="refnamediv"
><A
NAME="AEN161609"
></A
><P
>    (PHP 5)</P
>stream_socket_client&nbsp;--&nbsp;
     Open Internet or Unix domain socket connection
    </DIV
><DIV
CLASS="refsect1"
><A
NAME="AEN161612"
></A
><H2
>Description</H2
>resource <B
CLASS="methodname"
>stream_socket_client</B
> ( string remote_socket [, int &#38;errno [, string &#38;errstr [, float timeout [, int flags [, resource context]]]]] )<BR
></BR
><P
>&#13;     Initiates a stream or datagram connection to the destination specified
     by <VAR
CLASS="parameter"
>remote_socket</VAR
>.  The type of socket created
     is determined by the transport specified using standard URL formatting:
     <VAR
CLASS="literal"
>transport://target</VAR
>.  For Internet Domain sockets
     (AF_INET) such as TCP and UDP, the <VAR
CLASS="literal"
>target</VAR
> portion
     of the <VAR
CLASS="parameter"
>remote_socket</VAR
> parameter should consist of
     a hostname or IP address followed by a colon and a port number.  For Unix
     domain sockets, the <VAR
CLASS="parameter"
>target</VAR
> portion should point
     to the socket file on the filesystem.

     The optional <VAR
CLASS="parameter"
>timeout</VAR
> can be used to
     set a timeout in seconds for the connect system call.

     <VAR
CLASS="parameter"
>flags</VAR
> is a bitmask field which may be set to any
     combination of connection flags.  Currently the selection of connection
     flags is limited to <TT
CLASS="constant"
><B
>STREAM_CLIENT_CONNECT</B
></TT
> (default),
     <TT
CLASS="constant"
><B
>STREAM_CLIENT_ASYNC_CONNECT</B
></TT
> and
     <TT
CLASS="constant"
><B
>STREAM_CLIENT_PERSISTENT</B
></TT
>.
    </P
><DIV
CLASS="note"
><BLOCKQUOTE
CLASS="note"
><P
><B
>Nota: </B
>
      If you need to set a timeout for reading/writing data over the socket,
      use <A
HREF="function.stream-set-timeout.html"
><B
CLASS="function"
>stream_set_timeout()</B
></A
>, as the <VAR
CLASS="parameter"
>timeout</VAR
>
      parameter to <B
CLASS="function"
>stream_socket_client()</B
> only applies while
      connecting the socket.
     </P
></BLOCKQUOTE
></DIV
><P
>&#13;     <B
CLASS="function"
>stream_socket_client()</B
> returns a
     stream resource which may
     be used together with the other file functions (such as
     <A
HREF="function.fgets.html"
><B
CLASS="function"
>fgets()</B
></A
>, <A
HREF="function.fgetss.html"
><B
CLASS="function"
>fgetss()</B
></A
>,
     <A
HREF="function.fwrite.html"
><B
CLASS="function"
>fwrite()</B
></A
>, <A
HREF="function.fclose.html"
><B
CLASS="function"
>fclose()</B
></A
>, and
     <A
HREF="function.feof.html"
><B
CLASS="function"
>feof()</B
></A
>).
    </P
><P
>&#13;     If the call fails, it will return <TT
CLASS="constant"
><B
>FALSE</B
></TT
> and if the optional
     <VAR
CLASS="parameter"
>errno</VAR
> and <VAR
CLASS="parameter"
>errstr</VAR
>
     arguments are present they will be set to indicate the actual
     system level error that occurred in the system-level
     <VAR
CLASS="literal"
>connect()</VAR
> call. If the value returned in
     <VAR
CLASS="parameter"
>errno</VAR
> is <VAR
CLASS="literal"
>0</VAR
> and the
     function returned <TT
CLASS="constant"
><B
>FALSE</B
></TT
>, it is an indication that the error
     occurred before the <VAR
CLASS="literal"
>connect()</VAR
> call. This is
     most likely due to a problem initializing the socket. Note that
     the <VAR
CLASS="parameter"
>errno</VAR
> and
     <VAR
CLASS="parameter"
>errstr</VAR
> arguments will always be passed by
     reference.
    </P
><P
>&#13;     Depending on the environment, the Unix domain or the optional
     connect timeout may not be available.  A list of available
     transports can be retrieved using <A
HREF="function.stream-get-transports.html"
><B
CLASS="function"
>stream_get_transports()</B
></A
>.
     See <A
HREF="transports.html"
>Appendice O</A
> for a list of built in transports.
    </P
><P
>&#13;     The stream will by default be opened in blocking mode.  You can
     switch it to non-blocking mode by using
     <A
HREF="function.stream-set-blocking.html"
><B
CLASS="function"
>stream_set_blocking()</B
></A
>.
     <TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
CLASS="EXAMPLE"
><TR
><TD
><DIV
CLASS="example"
><A
NAME="AEN161674"
></A
><P
><B
>Esempio 1. <B
CLASS="function"
>stream_socket_client()</B
> Example</B
></P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
CELLPADDING="5"
><TR
><TD
><code><font color="#000000">
<font color="#0000BB">&lt;?php<br />$fp </font><font color="#007700">= </font><font color="#0000BB">stream_socket_client</font><font color="#007700">(</font><font color="#DD0000">"tcp://www.example.com:80"</font><font color="#007700">, </font><font color="#0000BB">$errno</font><font color="#007700">, </font><font color="#0000BB">$errstr</font><font color="#007700">, </font><font color="#0000BB">30</font><font color="#007700">);<br />if (!</font><font color="#0000BB">$fp</font><font color="#007700">) {<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">"$errstr ($errno)&lt;br /&gt;</font><font color="#007700">\n</font><font color="#DD0000">"</font><font color="#007700">;<br />} else {<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">fwrite</font><font color="#007700">(</font><font color="#0000BB">$fp</font><font color="#007700">, </font><font color="#DD0000">"GET / HTTP/1.0\r\nHost: www.example.com\r\nAccept: */*\r\n\r\n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;while (!</font><font color="#0000BB">feof</font><font color="#007700">(</font><font color="#0000BB">$fp</font><font color="#007700">)) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#0000BB">fgets</font><font color="#007700">(</font><font color="#0000BB">$fp</font><font color="#007700">, </font><font color="#0000BB">1024</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">fclose</font><font color="#007700">(</font><font color="#0000BB">$fp</font><font color="#007700">);<br />}<br /></font><font color="#0000BB">?&gt;</font>
</font>
</code></TD
></TR
></TABLE
></DIV
></TD
></TR
></TABLE
>
     The example below shows how to retrieve the day and time
     from the UDP service "daytime" (port 13) in your own machine.
     <TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
CLASS="EXAMPLE"
><TR
><TD
><DIV
CLASS="example"
><A
NAME="AEN161678"
></A
><P
><B
>Esempio 2. Using UDP connection</B
></P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
CELLPADDING="5"
><TR
><TD
><code><font color="#000000">
<font color="#0000BB">&lt;?php<br />$fp </font><font color="#007700">= </font><font color="#0000BB">stream_socket_client</font><font color="#007700">(</font><font color="#DD0000">"udp://127.0.0.1:13"</font><font color="#007700">, </font><font color="#0000BB">$errno</font><font color="#007700">, </font><font color="#0000BB">$errstr</font><font color="#007700">);<br />if (!</font><font color="#0000BB">$fp</font><font color="#007700">) {<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">"ERROR: $errno - $errstr&lt;br /&gt;</font><font color="#007700">\n</font><font color="#DD0000">"</font><font color="#007700">;<br />} else {<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">fwrite</font><font color="#007700">(</font><font color="#0000BB">$fp</font><font color="#007700">, </font><font color="#DD0000">"\n"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#0000BB">fread</font><font color="#007700">(</font><font color="#0000BB">$fp</font><font color="#007700">, </font><font color="#0000BB">26</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">fclose</font><font color="#007700">(</font><font color="#0000BB">$fp</font><font color="#007700">);<br />}<br /></font><font color="#0000BB">?&gt;</font>
</font>
</code></TD
></TR
></TABLE
></DIV
></TD
></TR
></TABLE
>
     <DIV
CLASS="warning"
><P
></P
><TABLE
CLASS="warning"
BORDER="1"
WIDTH="100%"
><TR
><TD
ALIGN="CENTER"
><B
>Avvertimento</B
></TD
></TR
><TR
><TD
ALIGN="LEFT"
><P
>&#13;        UDP sockets will sometimes appear to have opened without an error,
        even if the remote host is unreachable.  The error will only
        become apparent when you read or write data to/from the socket.
        The reason for this is because UDP is a "connectionless" protocol,
        which means that the operating system does not try to establish
        a link for the socket until it actually needs to send or receive data.
      </P
></TD
></TR
></TABLE
></DIV
>
    </P
><DIV
CLASS="note"
><BLOCKQUOTE
CLASS="note"
><P
><B
>Nota: </B
>Nella specifica numerica degli indirizzi IPv6 
(es. fe80::1) occorre racchiudere l'IP tra parentesi quadre. Ad esempio,  
<VAR
CLASS="literal"
>tcp://[fe80::1]:80</VAR
>.</P
></BLOCKQUOTE
></DIV
><P
>&#13;     See also <A
HREF="function.stream-socket-server.html"
><B
CLASS="function"
>stream_socket_server()</B
></A
>, 
     <A
HREF="function.stream-set-blocking.html"
><B
CLASS="function"
>stream_set_blocking()</B
></A
>,
     <A
HREF="function.stream-set-timeout.html"
><B
CLASS="function"
>stream_set_timeout()</B
></A
>, 
     <A
HREF="function.stream-select.html"
><B
CLASS="function"
>stream_select()</B
></A
>, 
     <A
HREF="function.fgets.html"
><B
CLASS="function"
>fgets()</B
></A
>,
     <A
HREF="function.fgetss.html"
><B
CLASS="function"
>fgetss()</B
></A
>, <A
HREF="function.fwrite.html"
><B
CLASS="function"
>fwrite()</B
></A
>,
     <A
HREF="function.fclose.html"
><B
CLASS="function"
>fclose()</B
></A
>, <A
HREF="function.feof.html"
><B
CLASS="function"
>feof()</B
></A
>, and
     the <A
HREF="ref.curl.html"
>Curl extension</A
>.
    </P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="function.stream-socket-accept.html"
ACCESSKEY="P"
>Indietro</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Partenza</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="function.stream-socket-enable-crypto.html"
ACCESSKEY="N"
>Avanti</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>stream_socket_accept</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="ref.stream.html"
ACCESSKEY="U"
>Risali</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>stream_socket_enable_crypto</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>